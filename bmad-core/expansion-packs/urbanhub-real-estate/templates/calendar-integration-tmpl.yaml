# Calendar Integration Template
# Template for multi-platform calendar integration (Calendly, Google Calendar, Outlook)

calendar_integration:
  name: "{{integration_name}}"
  description: "{{integration_description}}"
  version: "1.0.0"
  
  # Platform Configuration
  platforms:
    calendly:
      enabled: {{calendly_enabled}}
      api_key: "{{CALENDLY_API_KEY}}"
      webhook_secret: "{{CALENDLY_WEBHOOK_SECRET}}"
      base_url: "https://api.calendly.com"
      organization: "{{calendly_organization}}"
      
      # Event Types Configuration
      event_types:
        property_tour:
          name: "{{property_tour_event_name}}"
          duration: 60 # minutes
          description: "{{property_tour_description}}"
          location:
            type: "physical"
            address: "{{property_address}}"
          questions:
            - "What type of property are you interested in?"
            - "What is your preferred move-in date?"
            - "Do you have any specific requirements?"
        
        virtual_tour:
          name: "{{virtual_tour_event_name}}"
          duration: 30 # minutes
          description: "{{virtual_tour_description}}"
          location:
            type: "zoom"
            details: "Zoom link will be provided"
      
      # Availability Configuration
      availability:
        timezone: "America/Mexico_City"
        business_hours:
          monday: { start: "09:00", end: "18:00" }
          tuesday: { start: "09:00", end: "18:00" }
          wednesday: { start: "09:00", end: "18:00" }
          thursday: { start: "09:00", end: "18:00" }
          friday: { start: "09:00", end: "18:00" }
          saturday: { start: "10:00", end: "16:00" }
          sunday: { enabled: false }
        
        buffer_time:
          before: 15 # minutes
          after: 15 # minutes
        
        advance_booking:
          minimum_hours: 2
          maximum_days: 30
    
    google_calendar:
      enabled: {{google_calendar_enabled}}
      credentials:
        client_id: "{{GOOGLE_CLIENT_ID}}"
        client_secret: "{{GOOGLE_CLIENT_SECRET}}"
        redirect_uri: "{{GOOGLE_REDIRECT_URI}}"
      
      scopes:
        - "https://www.googleapis.com/auth/calendar"
        - "https://www.googleapis.com/auth/calendar.events"
      
      calendars:
        primary:
          id: "{{google_calendar_id}}"
          name: "{{google_calendar_name}}"
          timezone: "America/Mexico_City"
        
        property_tours:
          id: "{{property_tours_calendar_id}}"
          name: "UrbanHub Property Tours"
          color: "#4285f4"
      
      event_templates:
        property_tour:
          summary: "Property Tour - {{contact_name}} - {{property_name}}"
          description: |
            Property Tour Appointment
            
            Contact: {{contact_name}}
            Phone: {{contact_phone}}
            Email: {{contact_email}}
            
            Property: {{property_name}}
            Address: {{property_address}}
            
            Interest: {{property_interest}}
            Budget: {{budget_range}}
            
            Notes: {{additional_notes}}
            
            Leasing Agent: {{leasing_agent}}
            
            Generated by UrbanHub AI Assistant
          location: "{{property_address}}"
          duration: 60 # minutes
          reminders:
            - method: "email"
              minutes: 1440 # 24 hours
            - method: "popup"
              minutes: 30
    
    outlook:
      enabled: {{outlook_enabled}}
      credentials:
        client_id: "{{OUTLOOK_CLIENT_ID}}"
        client_secret: "{{OUTLOOK_CLIENT_SECRET}}"
        redirect_uri: "{{OUTLOOK_REDIRECT_URI}}"
      
      scopes:
        - "https://graph.microsoft.com/calendars.readwrite"
        - "https://graph.microsoft.com/user.read"
      
      calendar_settings:
        default_calendar: "{{outlook_calendar_id}}"
        timezone: "America/Mexico_City"
        working_hours:
          start: "09:00"
          end: "18:00"
          days: ["monday", "tuesday", "wednesday", "thursday", "friday"]
  
  # Booking Configuration
  booking:
    default_duration: 60 # minutes
    buffer_times:
      before_appointment: 15 # minutes
      after_appointment: 15 # minutes
    
    advance_booking:
      minimum_notice: 2 # hours
      maximum_advance: 30 # days
    
    conflict_resolution:
      auto_reschedule: false
      suggest_alternatives: true
      max_alternatives: 3
    
    confirmation:
      auto_confirm: {{auto_confirm_bookings}}
      require_approval: {{require_booking_approval}}
      confirmation_template: "booking_confirmation"
    
    cancellation:
      policy:
        minimum_notice: 2 # hours
        penalty: false
      reschedule_options: true
      cancellation_template: "booking_cancellation"
  
  # Leasing Agent Configuration
  leasing_agents:
    - id: "{{agent_1_id}}"
      name: "{{agent_1_name}}"
      email: "{{agent_1_email}}"
      phone: "{{agent_1_phone}}"
      properties: ["{{agent_1_properties}}"]
      languages: ["spanish", "english"]
      specialties: ["{{agent_1_specialties}}"]
      availability:
        monday: { start: "09:00", end: "18:00" }
        tuesday: { start: "09:00", end: "18:00" }
        wednesday: { start: "09:00", end: "18:00" }
        thursday: { start: "09:00", end: "18:00" }
        friday: { start: "09:00", end: "18:00" }
        saturday: { start: "10:00", end: "16:00" }
      calendar_integration:
        google: "{{agent_1_google_calendar}}"
        outlook: "{{agent_1_outlook_calendar}}"
    
    - id: "{{agent_2_id}}"
      name: "{{agent_2_name}}"
      email: "{{agent_2_email}}"
      phone: "{{agent_2_phone}}"
      properties: ["{{agent_2_properties}}"]
      languages: ["spanish", "english"]
      specialties: ["{{agent_2_specialties}}"]
      availability:
        monday: { start: "09:00", end: "18:00" }
        tuesday: { start: "09:00", end: "18:00" }
        wednesday: { start: "09:00", end: "18:00" }
        thursday: { start: "09:00", end: "18:00" }
        friday: { start: "09:00", end: "18:00" }
        saturday: { start: "10:00", end: "16:00" }
      calendar_integration:
        google: "{{agent_2_google_calendar}}"
        outlook: "{{agent_2_outlook_calendar}}"
  
  # Webhook Configuration
  webhooks:
    enabled: true
    endpoints:
      booking_created: "{{webhook_base_url}}/calendar/booking-created"
      booking_updated: "{{webhook_base_url}}/calendar/booking-updated"
      booking_cancelled: "{{webhook_base_url}}/calendar/booking-cancelled"
      booking_completed: "{{webhook_base_url}}/calendar/booking-completed"
    
    authentication:
      method: "signature"
      secret: "{{CALENDAR_WEBHOOK_SECRET}}"
    
    retry_policy:
      max_attempts: 3
      delay_seconds: [1, 5, 15]
  
  # Integration Mappings
  integrations:
    bird:
      enabled: true
      contact_mapping:
        name: "contact.name"
        phone: "contact.msisdn"
        email: "contact.email"
        property_interest: "contact.attributes.propertyInterest"
        budget: "contact.attributes.budget"
        timeline: "contact.attributes.timeline"
    
    hubspot:
      enabled: true
      sync_appointments: true
      create_meetings: true
      update_deal_stage: true
      
      field_mapping:
        contact_id: "hubspot_contact_id"
        deal_id: "hubspot_deal_id"
        appointment_date: "tour_scheduled_date"
        leasing_agent: "assigned_leasing_agent"
        property_interest: "urbanhub_property_interest"
      
      deal_stage_updates:
        booking_created: "{{hubspot_tour_scheduled_stage}}"
        booking_completed: "{{hubspot_tour_completed_stage}}"
        booking_cancelled: "{{hubspot_tour_cancelled_stage}}"
  
  # Notification Templates
  notifications:
    email:
      booking_confirmation:
        subject: "Confirmaci√≥n de Visita - {{property_name}}"
        template: |
          Hola {{contact_name}},
          
          ¬°Excelente! Hemos confirmado tu visita a {{property_name}}.
          
          Detalles de tu cita:
          üìÖ Fecha: {{appointment_date}}
          üïï Hora: {{appointment_time}}
          üìç Ubicaci√≥n: {{property_address}}
          üë• Asesor: {{leasing_agent_name}}
          
          ¬øQu√© necesitas traer?
          - Identificaci√≥n oficial
          - Comprobantes de ingresos (opcional)
          - Lista de preguntas o dudas
          
          Si necesitas reprogramar o cancelar, puedes hacerlo hasta 2 horas antes de la cita.
          
          ¬°Nos vemos pronto!
          Equipo UrbanHub
      
      booking_reminder:
        subject: "Recordatorio: Visita a {{property_name}} ma√±ana"
        template: |
          Hola {{contact_name}},
          
          Te recordamos que tienes una visita programada:
          
          üìÖ Ma√±ana {{appointment_date}}
          üïï {{appointment_time}}
          üìç {{property_address}}
          
          Tu asesor {{leasing_agent_name}} te estar√° esperando.
          Tel√©fono de contacto: {{leasing_agent_phone}}
          
          ¬°Esperamos verte pronto!
          Equipo UrbanHub
    
    sms:
      booking_confirmation:
        template: "üè† Confirmado! Visita a {{property_name}} el {{appointment_date}} a las {{appointment_time}}. Asesor: {{leasing_agent_name}}. ¬øDudas? WhatsApp: {{contact_whatsapp}}"
      
      booking_reminder:
        template: "üîî Recordatorio: Visita a {{property_name}} ma√±ana {{appointment_time}}. Ubicaci√≥n: {{property_address}}. Nos vemos ah√≠!"
    
    whatsapp:
      booking_confirmation:
        template: |
          üéâ *¬°Confirmado!*
          
          Tu visita a *{{property_name}}* est√° agendada:
          
          üìÖ *{{appointment_date}}*
          üïï *{{appointment_time}}*
          üìç *{{property_address}}*
          üë• *{{leasing_agent_name}}*
          
          Te enviar√© un recordatorio 24 horas antes. ¬°Nos vemos pronto! üòä
  
  # Business Rules
  business_rules:
    property_matching:
      josefa:
        target_audience: ["young_professionals", "students", "first_time_renters"]
        optimal_times: ["weekday_afternoons", "saturday_mornings"]
      
      matilde:
        target_audience: ["professionals", "couples", "small_families"]
        optimal_times: ["weekends", "weekday_evenings"]
    
    agent_assignment:
      criteria:
        - "property_specialization"
        - "language_preference"
        - "availability"
        - "customer_type"
      
      fallback:
        - "any_available_agent"
        - "queue_for_next_available"
        - "offer_alternative_times"
    
    pricing_integration:
      show_pricing: {{show_pricing_in_calendar}}
      require_prequalification: {{require_prequalification}}
      budget_matching: true
  
  # Performance and Monitoring
  monitoring:
    enabled: true
    metrics:
      booking_conversion_rate: true
      no_show_rate: true
      reschedule_rate: true
      agent_utilization: true
      customer_satisfaction: true
    
    alerts:
      high_no_show_rate: 0.15
      low_booking_rate: 0.25
      agent_overbooked: true
      integration_failures: true
    
    reporting:
      daily_bookings: true
      weekly_performance: true
      monthly_trends: true
      agent_performance: true

# Template Usage Instructions:
# 1. Replace all {{variable}} placeholders with environment-specific values
# 2. Configure platform credentials and authentication
# 3. Customize availability and booking rules
# 4. Set up webhook endpoints and notification templates
# 5. Test integration with all platforms
# 6. Monitor performance and adjust configuration as needed

# Platform-Specific Notes:
# - Calendly: Requires paid plan for API access and advanced features
# - Google Calendar: Requires OAuth setup and API credentials
# - Outlook: Requires Microsoft Graph API permissions
# - All platforms: Test webhook delivery and authentication